


server = connect_server()

shared_secret_key = diffieHellman(server)


while(1) {
    command = read_keyboard_command

    add_checksum(command)

    encrypt(command, shared_secret_key)

    write(command)

    while(1) {
        encrypted_answer = socket_read()

        answer = decrypt(encrypted_answer, symmetric key)

        check_result = check_sum(answer)

        if(check_result == bad_sum) {
            print(connection compromised, something is modifying your packets)
            exit()            
        }

        if(ends_with('\r\r\r', answer)) {
            remove_trail('\r\r\r', answer)
            print(answer)
            break
        }

        print(answer)
    }
}